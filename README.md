Universal API Comparison Tool
A powerful, command-line tool designed to compare two API specifications or responses. It provides a multi-layered analysis, including endpoint-level diffs for OpenAPI specs, deep structural comparisons for JSON/YAML, and a semantic summary generated by a local Large Language Model (LLM).

This tool is perfect for developers, QA engineers, and DevOps professionals who need to track API changes, identify breaking changes, and understand the impact of new versions.

‚ú® Key Features
Multi-Format Support: Natively parses and compares a wide range of formats:

JSON (.json)

YAML (.yaml, .yml)

OpenAPI / Swagger (JSON or YAML)

API Blueprint (.apib)

CSV (.csv)

Plain Text performance logs like ApacheBench (.txt, .log)

Flexible Input Sources: Load API data from:

Local Files

Remote URLs

Direct raw JSON strings

Three-Layer Analysis:

üõ£Ô∏è OpenAPI Endpoint Analysis: If both inputs are OpenAPI/Swagger specs, it provides a high-level summary of added, removed, or modified endpoints, parameters, and response types.

üîç Structural Difference: Using deepdiff, it performs a precise, field-by-field comparison of the structure of any two JSON-like objects.

üß† LLM-Powered Semantic Summary: Leverages a local LLM (e.g., Mistral 7B) to provide an intelligent, human-readable summary of the differences, focusing on the semantic impact (e.g., backward compatibility, authentication changes, performance implications).

Local & Private: By using llama-cpp-python, all analysis, including the LLM summary, is performed locally on your machine. No data is sent to external services.

GPU Acceleration: The script is configured to use GPU layers for the LLM, significantly speeding up the analysis.

Clear & Tabulated Output: All comparisons are presented in clean, easy-to-read tables using tabulate.

‚öôÔ∏è Setup and Installation
1. Prerequisites
Python 3.8+

Git

NVIDIA GPU with CUDA drivers installed (for LLM acceleration).

Node.js and npm: Required only if you need to parse API Blueprint (.apib) files.

2. Clone the Repository
Bash

git clone <your-repository-url>
cd <your-repository-directory>
3. Install Python Dependencies
It's highly recommended to use a virtual environment.

Bash

python -m venv venv
source venv/bin/activate  # On Windows, use `venv\Scripts\activate`
Install the required packages. For GPU support with llama-cpp-python, we need to set specific compilation flags.

Bash

# For NVIDIA GPUs
CMAKE_ARGS="-DLLAMA_CUBLAS=on" pip install llama-cpp-python
# Install other dependencies
pip install torch deepdiff pyyaml tabulate requests sentence-transformers
Note: Ensure your torch installation is compatible with your CUDA version.

4. Install Node.js Dependency (Optional)
If you plan to compare .apib files, you'll need the protagonist parser, which can be run via npx. You don't need to install it globally. If you don't have Node.js, you can download it from nodejs.org.

5. Download an LLM Model
This script is designed to run a local LLM in GGUF format.

Download a compatible model. The one specified in the script is a good starting point: mistral-7b-instruct-v0.1.Q4_K_M.gguf.

Create a mod directory (or any directory of your choice) and place the downloaded .gguf file inside.

6. Configure the Script
Open the Python script and update the model_path variable to point to the location of your downloaded LLM model.

Python

# ---- Load models ----
model_path = r"path/to/your/mod/mistral-7b-instruct-v0.1.Q4_K_M.gguf"
üöÄ Usage
The tool is run from the command line, providing a pair of inputs to compare.

Comparing Local Files
Use the --file1 and --file2 arguments for any supported file type.



python api_comparator.py --file1 v1.json --file2 v2.json
python api_comparator.py --file1 old_spec.yaml --file2 new_spec.yaml
python api_comparator.py --file1 results1.csv --file2 results2.csv
For OpenAPI/Swagger files specifically, you can use the --openapi1 and --openapi2 aliases:



python api_comparator.py --openapi1 swagger_v1.yml --openapi2 swagger_v2.yml
Comparing Remote URLs
Fetch and compare specifications directly from URLs.



python api_comparator.py --url1 https://petstore.swagger.io/v2/swagger.json --url2 https://petstore3.swagger.io/api/v3/openapi.json
Comparing Raw JSON Strings
Pass JSON content directly as command-line arguments.



python api_comparator.py --str1 '{"id": 1, "status": "active"}' --str2 '{"id": "001", "status": "enabled", "user": "admin"}'

## üìä Example Output

When you run the script, it will print up to three comparison tables depending on the input type.

### 1. OpenAPI Endpoint-Level Differences
*(This section appears only for OpenAPI specs)*

| Type    | Method | Path            | Detail                                                                           |
|:--------|:-------|:----------------|:---------------------------------------------------------------------------------|
| Added   | POST   | `/users/{id}/tag` | Present only in API 2                                                            |
| Removed | DELETE | `/users/{id}`     | Present only in API 1                                                            |
| Param - | GET    | `/users/{id}`     | Missing in API 2 (present in API 1): `version@query`                               |
| Resp ~  | GET    | `/users/{id}`     | Status 200 content-types differ: API1=`['application/json']` vs API2=`['application/json', 'application/xml']` |

### 2. JSON Structural Differences
*(This section appears for any dictionary/list inputs)*

| Change Type       | Path           | API 1 Value | API 2 Value |
|:------------------|:---------------|:------------|:------------|
| Type Changes      | `root['id']`   | 1           | '001'       |
| Dictionary Item Added | `root['user']` | N/A         | 'admin'     |
| Values Changed    | `root['status']`| 'active'    | 'enabled'   |

### 3. Dynamic LLM Comparison Summary
*(This section appears for any dictionary/list inputs)*

| Category               | API 1 Field/Value | API 2 Field/Value   | Difference Description                                          |
|:-----------------------|:------------------|:--------------------|:----------------------------------------------------------------|
| **Data Type Change** | id: `1` (int)       | id: `"001"` (string)  | The 'id' field changed from an integer to a string. This is a breaking change for clients expecting a numeric ID. |
| **Field Addition** | N/A               | user: `"admin"`       | A new 'user' field was added. This is non-breaking but may require client updates to be utilized. |
| **Value Change (Enum)**| status: `"active"`| status: `"enabled"`   | The value for 'status' has changed. Clients need to handle the new "enabled" enum value. |
